<!DOCTYPE html>
<html lang="en">
<head>
    <link rel="icon" href="logo.png" type="image/x-icon">
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Sign Up Page</title>
</head>
<body>
    <style>
        /* Your CSS styles here */
    </style>
    <div class="login-container">
        <div class="login-header">
            <h2>Login</h2>
        </div>
        <form id="login-form">
            <div class="form-group">
                <label for="username">Name</label>
                <input type="text" id="username" name="username" required>
            </div>
            <div class="form-group">
                <label for="school">School</label>
                <input type="text" id="school" name="school" required>
            </div>
            <div class="form-group">
                <label for="scno">Scholar Number</label>
                <input type="number" id="scno" name="scno" required>
            </div>
            <div class="form-group">
                <label for="email">Email</label>
                <input type="email" id="email" name="email" required>
            </div>
            <div class="form-group">
                <label for="class">Class:</label>
                <select name="class" required>
                    <option value="9th" selected>9th</option>
                    <option value="10th">10th</option>
                    <option value="11th">11th</option>
                    <option value="12th">12th</option>
                </select><br>
            </div>
            <div class="form-group">
                <label for="section">Section:</label>
                <select name="section" required>
                    <option value="A" selected>A</option>
                    <option value="B">B</option>
                    <option value="C">C</option>
                    <option value="D">D</option>
                </select><br>
            </div>
            <div class="form-group">
                <center>
                    <input type="submit" value="Login">
                </center>
            </div>
        </form>
    </div>
    <script>
        const scriptURL = 'https://script.google.com/macros/s/AKfycbz_wtIuxovVnuiffvcOiv0SCE7ILZdkpnEFE_KJucXa8_pvfKnHMWjhMjr2wnvS9oZe/exec';
        const form = document.forms['login-form'];

        function doPost(e) {
            var sheet = SpreadsheetApp.openById('Your_Sheet_ID').getActiveSheet();
        
            // Get the data from the form
            var usernameData = e.parameter.username;
            var schoolData = e.parameter.school;
            var scnoData = e.parameter.scno;
            var emailData = e.parameter.email;
            var classData = e.parameter.class;
            var sectionData = e.parameter.section;
        
            // Append the data to the Google Sheet
            sheet.appendRow([usernameData, schoolData, scnoData, emailData, classData, sectionData]);
        
            // Return a success message
            return ContentService.createTextOutput('Data added to the Google Sheet.');
        }

        form.addEventListener('submit', e => {
            e.preventDefault();

            // Get the class and section data from the form
            const usernameData = form.elements['username'].value;
            const schoolData = form.elements['school'].value;
            const scnoData = form.elements['scno'].value;
            const emailData = form.elements['email'].value;
            const classData = form.elements['class'].value;
            const sectionData = form.elements['section'].value;

            // Check if email, username, and scno are unique before submitting
            if (isUnique(usernameData, emailData, scnoData)) {
                // Create a FormData object to send all form data
                const formData = new FormData(form);
                formData.append('username', usernameData);
                formData.append('school', schoolData);
                formData.append('scno', scnoData);
                formData.append('email', emailData);
                formData.append('class', classData);
                formData.append('section', sectionData); 

                // Redirect based on class and section
                switch (classData) {
                    case '9th':
                        if (sectionData === 'A') {
                            window.location.href = 'c9sA.html'; // Redirect to page 1
                        }
                        break;
                    case '9th':
                        if (sectionData === 'B') {
                            window.location.href = 'c9sB.html'; // Redirect to page 2
                        }
                        break;
                    // Add more cases for other class and section combinations
                    default:
                        // Handle other cases or show an error message
                        alert('Invalid selection');
                }

                // Send the form data to Google Sheets
                fetch(scriptURL, { method: 'POST', body: formData })
                    .then(response => alert('Success!', response))
                    .catch(error => alert('Error!', error.message));
            } else {
                alert('Email, username, or scno is not unique. Please provide unique values.');
            }
        });

        // Function to check if email, username, and scno are unique
        function isUnique(username, email, scno) {
            // Replace with your logic to check uniqueness from Google Sheets
            // You can use the Google Apps Script to read existing data from the sheet
            // and compare it with the submitted values.
            // If any of them is not unique, return false; otherwise, return true.
            // Here's a simplified example of how you can do this:
            
            var sheet = SpreadsheetApp.openById('Your_Sheet_ID').getActiveSheet();
            var data = sheet.getDataRange().getValues();

            for (var i = 1; i < data.length; i++) {
                var row = data[i];
                var existingUsername = row[0];
                var existingEmail = row[3];
                var existingScno = row[2];

                if (existingUsername === username || existingEmail === email || existingScno === scno) {
                    return false;
                }
            }
            
            return true;
        }
    </script>
</body>
</html>
